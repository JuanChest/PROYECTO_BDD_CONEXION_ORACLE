-- Scripts para la fragmentaci√≥n horizontal de las tablas: TIENDA, INVENTARIO, VENTAS.
-- TIENDA
CREATE TABLE TIENDA_NORTE AS
SELECT * FROM TIENDA WHERE REGION_ID = 1;

ALTER TABLE TIENDA_NORTE
ADD CONSTRAINT PK_TIENDA_NORTE PRIMARY KEY (ID_TIENDA);

-- INVENTARIO
CREATE TABLE INVENTARIO_NORTE AS
SELECT inv.*
FROM INVENTARIO inv
JOIN TIENDA tienda ON inv.ID_TIENDA = tienda.ID_TIENDA
WHERE tienda.REGION_ID = 1;

ALTER TABLE INVENTARIO_NORTE
ADD CONSTRAINT PK_INVENTARIO_NORTE PRIMARY KEY (INVENTARIO_ID);

ALTER TABLE INVENTARIO_NORTE
ADD CONSTRAINT FK_INVENTARIO_NORTE_TIENDA
FOREIGN KEY (ID_TIENDA) REFERENCES TIENDA_NORTE(ID_TIENDA);

-- VENTAS
CREATE TABLE VENTAS_NORTE AS
SELECT v.*
FROM VENTAS v
JOIN TIENDA t ON v.ID_TIENDA = t.ID_TIENDA
WHERE t.REGION_ID = 1;

ALTER TABLE VENTAS_NORTE
ADD CONSTRAINT PK_VENTAS_NORTE PRIMARY KEY (VENTA_ID);

ALTER TABLE VENTAS_NORTE
ADD CONSTRAINT FK_VENTAS_NORTE_TIENDA
FOREIGN KEY (ID_TIENDA) REFERENCES TIENDA_NORTE(ID_TIENDA);



