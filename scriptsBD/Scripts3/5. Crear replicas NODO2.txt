-- EN NODO 2
-- ===========================================
-- Conceder permisos en SYSTEM
GRANT SELECT ON PRODUCTO TO nodo2;
GRANT SELECT ON CLIENTE TO nodo2;
GRANT SELECT ON PROVEEDOR TO nodo2;
GRANT CREATE MATERIALIZED VIEW TO nodo2;
GRANT CREATE TABLE TO nodo2;
GRANT CREATE JOB TO nodo2;


-- Vista materializada para PRODUCTO
CREATE MATERIALIZED VIEW PRODUCTO_REP
REFRESH FAST START WITH SYSDATE NEXT SYSDATE + (1/1440)
AS
SELECT * FROM PRODUCTO@db_link_nodo1;

-- Vista materializada para PROVEEDOR
CREATE MATERIALIZED VIEW PROVEEDOR_REP
REFRESH FAST START WITH SYSDATE NEXT SYSDATE + (1/1440)
AS
SELECT * FROM PROVEEDOR@db_link_nodo1;

-- Vista materializada para CLIENTE (replicada completamente)
CREATE MATERIALIZED VIEW CLIENTE_REP
REFRESH FAST START WITH SYSDATE NEXT SYSDATE + (1/1440)
AS
SELECT * FROM CLIENTE@db_link_nodo1;

-- RESTRICCIÓN DE ACCESOS SOLO-LECTURA (opcional en Oracle)
-- Oracle no maneja REVOKE directamente como en otros RDBMS para usuarios como 'nodo2'
-- Si estás usando un usuario llamado nodo2, entonces esto tendría sentido:
REVOKE INSERT, UPDATE, DELETE ON PRODUCTO_REP FROM nodo2;
REVOKE INSERT, UPDATE, DELETE ON PROVEEDOR_REP FROM nodo2;
REVOKE INSERT, UPDATE, DELETE ON CLIENTE_REP FROM nodo2;
